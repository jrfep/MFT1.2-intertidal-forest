---
output: html_document
editor_options:
  chunk_output_type: console
---


```sh
source $HOME/proyectos/IUCN-GET/MFT1.2-intertidal-forest/env/project-env.sh
cd $SCRIPTDIR/www/xml
for ARCH in $(ls *xml)
do
  xmllint --format $ARCH > tst
  mv tst $ARCH
done

```

```{r}
require(dplyr)
require(XML)
require(xml2)
require(sf)
require(readr)

source(sprintf("%s/proyectos/IUCN-GET/MFT1.2-intertidal-forest/env/project-env.R",Sys.getenv("HOME")))
for (rda.file in c("mgt-point-data.rda","selected-units.rda","species-occurrence.rda"))
  load(file=sprintf("%s/www/Rdata/%s",script.dir,rda.file))
```

Assessment unit correspond to _Regional ecosystem subgroups_ (level 4 of the IUCN Global Ecosystem Typology).


### Abiotic environment

Here I write some placeholder text based on the profile for the ecosystem functional group.

```{r}

  
for (k in sample(dir(sprintf("%s/www/xml/",script.dir),"xml",full.names = TRUE))) {
}
  doc <- xmlTreeParse(k) 
  
#    doc <- read_xml(k)
    unit_name <- doc %>% xml_find_all("//AT-name[@lang='en']") %>% xml_text()
    cdg <- doc %>% xml_find_all("//AT-id") %>% xml_text()

    AT.abiotic <- xmlElementsByTagName(xmlRoot(doc),"Abiotic-environment",recursive=T)
  
    
     doc %>% xml_find_all("//Abiotic-environment")  %>% xml_add_child("Abiotic-Summaries") %>% xml_add_child("Abiotic-Summary",attrs=list(lang="en"), if_else(grepl("Temperate",unit_name),paste(abiotic1,abiotic2),abiotic2))
    
    write_xml(doc,file=k)  
    rm(doc)
    gc()



```


### Biotic processes
Here I write some placeholder text based on the profile for the ecosystem functional group.
```{r}

```

### Ecosystem services
Here I write some placeholder text based on the profile for the ecosystem functional group.

### Threats
Here I write some placeholder text based on the profile for the ecosystem functional group.


### Conservation actions
Here I write some placeholder text based on the profile for the ecosystem functional group.

### Research needs
Here I write some placeholder text based on the profile for the ecosystem functional group.

### Conceptual ecosystem model
Here I write some placeholder text based on the profile for the ecosystem functional group.


### Collapse

Here I write some placeholders for collapse definitions based on the profile for the ecosystem functional group.

```{r}

```



```xml
<Assessment-Target date="" updated-by="" status="">
      <AT-id></AT-id>
      <AT-descriptions>
        <AT-description lang="en"></AT-description>
      </AT-descriptions>
      <AT-names>
        <AT-name lang="en"></AT-name>
      </AT-names>
      <Characteristic-biota>
        <taxons>
          <taxon></taxon>
        </taxons>
        <Biota-Summaries>
          <Biota-Summary lang="en"></Biota-Summary>
        </Biota-Summaries>
      </Characteristic-biota>
      <Abiotic-environment>
        <Abiotic-Summaries>
          <Abiotic-Summary lang="en"></Abiotic-Summary>
        </Abiotic-Summaries>
      </Abiotic-environment>
      <Biotic-processes>
        <Processes-Summaries>
          <Processes-Summary lang="en"></Processes-Summary>
        </Processes-Summaries>
      </Biotic-processes>
      <Ecosystem-services>
        <Services>
          <Ecosystem-service></Ecosystem-service>
        </Services>
        <Services-Summaries>
          <Services-Summary lang="en"></Services-Summary>
        </Services-Summaries>
      </Ecosystem-services>
      <Threats>
        <Threats-Summaries>
          <Threats-Summary lang="en"></Threats-Summary>
        </Threats-Summaries>
        <Threat>
          <Threat-names>
            <Threat-name lang="en"></Threat-name>
          </Threat-names>
          <Threat-Impact>
            <Threat-Timing id="" version="0" selected="" assigned-by=""></Threat-Timing>
            <Threat-Scope id="" version="0" selected="" assigned-by=""></Threat-Scope>
            <Threat-Severity id="" version="0" selected="" assigned-by=""></Threat-Severity>
          </Threat-Impact>
          <Threat-descriptions>
            <Threat-description lang="en"></Threat-description>
          </Threat-descriptions>
          <Threat-classification id="" version="0" selected="" assigned-by="">
            <Threat-classification-element level=""></Threat-classification-element>
          </Threat-classification>
        </Threat>
      </Threats>
      <Conservation-actions>
        <Conservation-Summaries>
          <Conservation-Summary lang="en"></Conservation-Summary>
        </Conservation-Summaries>
        <Conservation-action>
          <Conservation-action-names>
            <Conservation-action-name lang="en"></Conservation-action-name>
          </Conservation-action-names>
          <Conservation-action-descriptions>
            <Conservation-action-description lang="en"></Conservation-action-description>
          </Conservation-action-descriptions>
          <Conservation-action-classification id="" version="0" selected="" assigned-by="">
            <Conservation-action-classification-element level=""></Conservation-action-classification-element>
          </Conservation-action-classification>
        </Conservation-action>
      </Conservation-actions>
      <Research-needs>
        <Research-Summaries>
          <Research-Summary lang="en"></Research-Summary>
        </Research-Summaries>
        <Research-needed>
          <Research-needed-names>
            <Research-needed-name lang="en"></Research-needed-name>
          </Research-needed-names>
          <Research-needed-descriptions>
            <Research-needed-description lang="en"></Research-needed-description>
          </Research-needed-descriptions>
          <Research-needed-classification id="" version="0" selected="" assigned-by="">
            <Research-needed-classification-element level=""></Research-needed-classification-element>
          </Research-needed-classification>
        </Research-needed>
      </Research-needs>
      <Conceptual-ecosystem-model>
        <CEM-type graphic=""></CEM-type>
        <CEM-source></CEM-source>
        <CEM-summaries>
          <CEM-summary lang="en"></CEM-summary>
        </CEM-summaries>
      </Conceptual-ecosystem-model>
      <Classifications>
        <Classification-system id="" version="0" selected="" assigned-by="">
          <Classification-element level=""></Classification-element>
        </Classification-system>
      </Classifications>
      <Distribution>
        <Distribution-Summaries>
          <Distribution-Summary lang="en"></Distribution-Summary>
        </Distribution-Summaries>
        <Countries>
          <Country iso-code-2=""></Country>
        </Countries>
        <Geographic-region></Geographic-region>
        <Biogeographic-realms>
          <Biogeographic-realm></Biogeographic-realm>
        </Biogeographic-realms>
        <Region>
          <Region-classification-system id="" version="0" selected="" assigned-by="">
            <Region-classification-element level=""></Region-classification-element>
          </Region-classification-system>
        </Region>
        <Spatial-data>
          <Spatial-point datum="" proj="" type="lower-left-corner">
            <x></x>
            <y></y>
            <radius units=""></radius>
          </Spatial-point>
          <Spatial-point datum="" proj="" type="upper-right-corner">
            <x></x>
            <y></y>
            <radius units=""></radius>
          </Spatial-point>
        </Spatial-data>
      </Distribution>
      <Collapse-definition>
        <Collapse-Summaries>
          <Collapse-Summary lang="en"></Collapse-Summary>
        </Collapse-Summaries>
        <Spatial-collapse-definitions>
         <Spatial-collapse lang="en"></Spatial-collapse>
        </Spatial-collapse-definitions>
        <Functional-collapse-definitions>
         <Functional-collapse lang="en"></Functional-collapse>
        </Functional-collapse-definitions>
      </Collapse-definition>
    </Assessment-Target>
```
